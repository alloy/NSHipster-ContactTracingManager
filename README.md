Fork of @matttâ€™s code https://gist.github.com/mattt/17c880d64c362b923e13c765f5b1c75a
